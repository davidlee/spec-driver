---
id: IP-009
slug: cli-json-consistency-fixes
name: Implementation Plan - CLI JSON consistency fixes
created: '2025-11-03'
updated: '2025-11-03'
status: completed
kind: plan
aliases: []
---

```yaml supekku:plan.overview@v1
schema: supekku.plan.overview
version: 1
plan: IP-009
delta: DE-009
revision_links:
  aligns_with: []
specs:
  primary:
    - SPEC-110
  collaborators:
    - SPEC-120
requirements:
  targets:
    - PROD-010.FR-001
    - PROD-010.FR-002
    - PROD-010.FR-003
    - PROD-010.NF-003
  dependencies: []
phases:
  - id: IP-009.PHASE-01```

```yaml supekku:verification.coverage@v1
schema: supekku.verification.coverage
version: 1
subject: IP-009
entries:
  - artefact: VT-PROD010-JSON-001
    kind: VT
    requirement: PROD-010.FR-001
    phase: IP-009.PHASE-01
    status: verified
    notes: Unit tests verify --json flag on all list commands produces valid parseable JSON matching --format=json output. Tests in supekku/cli/test_cli.py::TestJSONFlagConsistency.
  - artefact: VT-PROD010-JSON-002
    kind: VT
    requirement: PROD-010.FR-002
    phase: IP-009.PHASE-01
    status: verified
    notes: Unit tests verify --json flag on all show commands produces structured output with consistent schema. Tests in supekku/cli/test_cli.py::TestShowCommandJSON.
  - artefact: VT-PROD010-FILTER-001
    kind: VT
    requirement: PROD-010.FR-003
    phase: IP-009.PHASE-01
    status: verified
    notes: Unit tests verify -s/--status filter on specs command filters correctly and matches deltas/adrs behavior. Tests in supekku/cli/test_cli.py::TestStatusFilterParity.
  - artefact: VH-PROD010-UX-001
    kind: VH
    requirement: PROD-010.NF-003
    phase: IP-009.PHASE-01
    status: verified
    notes: Manual validation confirmed all Priority 1 findings from UX research addressed. 74/74 CLI tests passing with 35 new tests covering all changes.
```

## 1. Summary
- **Delta**: DE-009 - <title>
- **Specs Impacted**: SPEC-002, PROD-YYY
- **Problems / Issues**: ISSUE-123, PROB-456
- **Desired Outcome**: <one-line description of the end state>

## 2. Context & Constraints
- **Current Behaviour**: <brief note or link to audit finding>
- **Target Behaviour**: <reference spec section / requirement IDs>
- **Dependencies**: <other deltas, releases, ops windows>
- **Constraints**: <time, rollout, tech debt>

## 3. Gate Check
- [ ] Backlog items linked and prioritised
- [ ] Spec(s) updated or delta specifies required changes
- [ ] Test strategy identified (unit/integration/system)
- [ ] Workspace/config changes assessed


> Tip: Plan phases up front, then create the phase sheet for the current phase only. Update later phases when you are ready to execute them.

## 4. Phase Overview
| Phase | Objective | Entrance Criteria | Exit Criteria / Done When | Phase Sheet |
| --- | --- | --- | --- | --- |
| Phase 0 - Research & Validation | Confirm assumptions, gather refs | Delta accepted, backlog reviewed | Open questions resolved, risks logged | `phases/phase-01.md` |
| Phase 1 - Design Revision Application | Apply design revision changes | Phase 0 complete | Code + tests updated, local checks passing | `phases/phase-02.md` |
| Phase 2 - Verification & Cleanup | Run verification suite, update docs | Phase 1 complete, CI green | All gates passed, docs updated | `phases/phase-03.md` |

*Adjust/add phases as needed; every phase must have clear gates. Phase sheets are authored one at a time using `supekku/templates/phase-sheet-template.md`.*

## 5. Phase Detail Snapshot
- **Research Notes**: `DE-009/notes.md` (Phase 0 output)
- **Design Revision**: `DE-009/DR-XXX.md`
- **Active Phase Sheet**: <link once created>
- **Parallelisable Work**: Flag tasks with `[P]` inside phase sheets
- **Plan Updates**: Update this plan when phase outcomes change (new risks, scope adjustments)

## 6. Testing & Verification Plan
- **Updated Suites**: <list unit/integration/system tests>
- **New Cases**: <outline key scenarios>
- **Tooling/Fixtures**: <mention new helpers/mocks>
- **Rollback Plan**: <if applicable>
- **Verification Coverage**: Cross-check `supekku:verification.coverage@v1` entries against phases and requirements.

## 7. Risks & Mitigations
| Risk | Mitigation | Owner |
| --- | --- | --- |
| e.g. `.viceignore` misconfiguration | Provide defaults, add logging | Dev |

## 8. Open Questions & Decisions
- [ ] Question/decision placeholder (resolve before exit)

## 9. Progress Tracking
- [ ] Phase 0 complete
- [ ] Phase 1 complete
- [ ] Phase 2 complete
- [ ] Verification gates passed

## 10. Notes / Links
- Audit reference: AUD-XXX (pending)
- Supporting docs: <links>
```
