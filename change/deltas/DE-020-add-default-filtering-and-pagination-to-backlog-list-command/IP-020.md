---
id: IP-020
slug: add-default-filtering-and-pagination-to-backlog-list-command
name: Implementation Plan - Add default filtering and pagination to backlog list command
created: '2025-11-08'
updated: '2025-11-08'
status: completed
kind: plan
aliases: []
---

```yaml supekku:plan.overview@v1
schema: supekku.plan.overview
version: 1
plan: IP-020
delta: DE-020
revision_links:
  aligns_with: []
specs:
  primary: []
  collaborators: []
requirements:
  targets: []
  dependencies: []
phases:
  - id: IP-020-P01
```

```yaml supekku:verification.coverage@v1
schema: supekku.verification.coverage
version: 1
subject: IP-020
entries:
  - artefact: VT-020-01
    kind: VT
    requirement: ISSUE-025
    status: planned
    notes: Unit tests for default filtering, pagination, and formatter feedback messages
  - artefact: VH-020-01
    kind: VH
    requirement: ISSUE-025
    status: planned
    notes: Manual UX validation - verify help text clarity, pager behavior, and user experience
```

## 1. Summary
- **Delta**: DE-020 - Add default filtering and pagination to backlog list command
- **Specs Impacted**: SPEC-113 (supekku/scripts/lib/backlog), SPEC-110 (supekku/cli), PROD-010 (CLI UX)
- **Problems / Issues**: ISSUE-025
- **Desired Outcome**: Backlog list hides resolved/implemented items by default, supports --all/-a flag, --limit for pagination (default 20), and --pager/-P for scrollable output

## 2. Context & Constraints
- **Current Behaviour**: `list_backlog()` in `supekku/cli/list.py:1229-1386` shows all items regardless of status; no pagination support; prioritize mode includes all items
- **Target Behaviour**:
  - Default: exclude `status: resolved` and `status: implemented`
  - Add `--all/-a` flag to include all statuses
  - Add `--limit N` (default 20) to cap results
  - Add `--pager/-P` to use typer.echo_via_pager
  - Prioritize mode respects same filtering
- **Dependencies**: None
- **Constraints**: Maintain backward compatibility; existing scripts should work (just see fewer results by default)

## 3. Gate Check
- [x] Backlog items linked and prioritised (ISSUE-025)
- [x] Spec(s) updated or delta specifies required changes (SPEC-113 stub - will update during implementation)
- [x] Test strategy identified (unit tests for formatters, integration tests for CLI)
- [x] Workspace/config changes assessed (no config changes needed)


> Tip: Plan phases up front, then create the phase sheet for the current phase only. Update later phases when you are ready to execute them.

## 4. Phase Overview
| Phase | Objective | Entrance Criteria | Exit Criteria / Done When | Phase Sheet |
| --- | --- | --- | --- | --- |
| Phase 1 - CLI Command Changes | Add new flags to list_backlog command | IP approved, gate check passed | Flags added, default filtering implemented, ruff/pylint pass | `phases/phase-01.md` |
| Phase 2 - Formatter Updates | Update formatters for pagination feedback | Phase 1 complete | Formatters handle truncation, show "X of Y" messages | `phases/phase-02.md` |
| Phase 3 - Testing & Documentation | Comprehensive tests + help text | Phase 2 complete | All tests pass, help text clear, processes.md updated | `phases/phase-03.md` |

*Adjust/add phases as needed; every phase must have clear gates. Phase sheets are authored one at a time using `.spec-driver/templates/phase-sheet-template.md`.*

## 5. Phase Detail Snapshot
- **Research Notes**: `DE-020/notes.md` (research complete - see below)
- **Design Revision**: `DE-020/DR-020.md`
- **Active Phase Sheet**: TBD (create with `uv run spec-driver create phase --plan IP-020`)
- **Parallelisable Work**: None identified
- **Plan Updates**: Update this plan when phase outcomes change (new risks, scope adjustments)

### Research Summary
- **Current implementation**: `list_backlog()` at `supekku/cli/list.py:1229-1386`
- **Key functions**:
  - `discover_backlog_items()` - returns all items, already sorted by ID
  - `sort_by_priority()` - applies registry ordering
  - `format_backlog_list_table()` - handles table/json/tsv formatting
- **Backlog model**: `BacklogItem` at `supekku/scripts/lib/backlog/models.py:9-26`
- **Existing tests**: `supekku/scripts/lib/formatters/backlog_formatters_test.py`
- **Status field**: Already present in frontmatter, values include: open, resolved, implemented, etc.

## 6. Testing & Verification Plan
- **Updated Suites**:
  - Unit: `supekku/scripts/lib/formatters/backlog_formatters_test.py` - add tests for pagination feedback
  - Integration: Add CLI tests for new flags (manual verification initially)
- **New Cases**:
  - Default filtering excludes resolved/implemented
  - `--all` includes all statuses
  - `--limit` caps output correctly
  - `--pager` uses typer.echo_via_pager
  - Prioritize mode respects filtering
  - Footer message displays when results truncated
- **Tooling/Fixtures**: Use existing BacklogItem test fixtures
- **Rollback Plan**: N/A - pure addition, no breaking changes
- **Verification Coverage**: VT-020-01 (unit tests), VH-020-01 (manual UX validation)

## 7. Risks & Mitigations
| Risk | Mitigation | Owner |
| --- | --- | --- |
| Breaking scripts that expect all items | Backward compatible - scripts just see fewer items, still valid | Dev |
| Users confused by missing items | Clear help text, informative footer message | Dev |
| Limit default (20) too low/high | Conservative default, easy to override with --limit or --all | Dev |

## 8. Open Questions & Decisions
- [x] Default limit of 20 - confirmed reasonable starting point
- [x] Pager flag as -P (not -v) - confirmed
- [x] Statuses to exclude: resolved, implemented - confirmed

## 9. Progress Tracking
- [x] Phase 1 complete (CLI command changes)
- [x] Phase 2 complete (formatter updates)
- [x] Phase 3 complete (testing & documentation)
- [x] Verification gates passed

## 10. Completion Summary

**Implemented 2025-11-08**

All objectives achieved:
- ✓ Default filtering excludes resolved/implemented (18 vs 26 items with --all)
- ✓ --all/-a flag includes all statuses
- ✓ --limit N caps results (default 20) with feedback message
- ✓ --pager/-P uses Rich console.pager()
- ✓ --order field supports: id, severity, status, kind (replaced --order-by-id)
- ✓ All 5 commands updated: backlog, issues, problems, improvements, risks
- ✓ Prioritize mode respects filtering
- ✓ All tests pass (14 formatter tests, 59 backlog tests)
- ✓ Ruff: clean
- ✓ Pylint: 8.62/10 (improved from 8.58)

## 11. Notes / Links
- Issue: ISSUE-025
- Key files:
  - `supekku/cli/list.py:1229-1386` (list_backlog function)
  - `supekku/scripts/lib/backlog/registry.py:335-429` (discover_backlog_items)
  - `supekku/scripts/lib/formatters/backlog_formatters.py:26-108` (format_backlog_list_table)
  - `supekku/scripts/lib/backlog/models.py:9-26` (BacklogItem)
- Rich pager docs: https://rich.readthedocs.io/en/stable/reference/console.html#rich.console.Console.pager
- API: `with console.pager(): console.print(output)` - context manager for paged output
