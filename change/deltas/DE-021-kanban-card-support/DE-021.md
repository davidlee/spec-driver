---
id: DE-021
slug: kanban-card-support
name: Delta - Card support (kanban board)
created: '2026-02-03'
updated: '2026-02-03'
status: draft
kind: delta
aliases: []
relations: []
applies_to:
  specs: []
  requirements: []
---

# DE-021 – Card support (kanban board)

```yaml supekku:delta.relationships@v1
schema: supekku.delta.relationships
version: 1
delta: DE-021
revision_links:
  introduces: []
  supersedes: []
specs:
  primary: []
  collaborators: []
requirements:
  implements: []
  updates: []
  verifies: []
phases:
  - IP-021.PHASE-01
  - IP-021.PHASE-02
  - IP-021.PHASE-03
```

## 1. Summary & Context
- **Backlog Driver**: IMPR-003 – `backlog/improvements/IMPR-003-kanban-support/IMPR-003.md`
- **Decision Context**: ADR-001 – `specify/decisions/ADR-001-use-spec-driver-to-build-spec-driver.md`
- **Implementation Plan**: [IP-021](./IP-021.md) – draft
- **Design Revision**: [DR-021](./DR-021.md) – draft
- **Scope**: Internal tooling improvement (no PROD/SPEC requirements explicitly targeted yet)

## 2. Motivation
We maintain Markdown “cards” under `kanban/` (e.g. `kanban/backlog/T123-some-task.md`),
but SpecDriver currently treats these as “just files”.

This delta adds first-class support for **cards** as an artifact type so that:
- ID-based linking survives folder moves (default board lanes, ad-hoc folders).
- We can express and query simple dependencies/links between cards and other IDs
  (ADRs, SPEC/PROD, deltas, etc).
- We get fast, reliable CLI workflows for resolving IDs to paths.

## 3. Scope & Objectives
**Primary Outcomes**
- Add `card` artifact support (ID prefix `T`) backed by a small domain registry + formatters.
- Add CLI commands:
  - `spec-driver create card "description"` (from `kanban/template.md`, allocate next `T###`)
  - `spec-driver list cards` (filters + `--format table|tsv|json`)
  - `spec-driver show card T123` (details; default scope `kanban/**`)
  - `spec-driver show card T123 -q` (print only the resolved path)
  - `spec-driver find card T123` (repo-wide filename search `^T123-.*\\.md$`)
- Card creation must rewrite only:
  - First H1 → `# T###: <description>`
  - `Created: YYYY-MM-DD` (insert if missing; prefer directly under H1)
  - All other template content remains user-controlled.

**Constraints**
- Markdown-first, minimal metadata. Do not require YAML frontmatter in cards.
- Keep CLI thin: args → registry → filter → formatter → output.
- Avoid premature abstraction: implement card-specific domain/formatters first.

## 4. Out of Scope
- “Move card between lanes” command (can remain `git mv`).
- “Normalize filenames” commands (`T123_foo.md` → `T123-foo.md`).
- Repo-wide reference search (e.g. “who mentions `T123` in body text?”).
  - Follow-up idea: `spec-driver find refs T123`.
- Rich dependency graph tooling (ordering/toposort/visualization).

## 5. Approach Overview
**System Touchpoints**
- Domain: `supekku/scripts/lib/cards/`
- Formatting: `supekku/scripts/lib/formatters/card_formatters.py`
- CLI: `supekku/cli/{create,list,show,find}.py` + `supekku/cli/main.py`
- Filesystem: `kanban/` + `kanban/template.md`

**Key Behaviours**
- ID allocation scans existing `kanban/**/T*.md` (max + 1).
- `show card` default scope is `kanban/**/T###-*.md`; `--anywhere` expands to repo-wide.
- `find card` is repo-wide filename search for `^T###-.*\\.md$`.

## 6. Verification Strategy
**Planned Verification Artefacts** (see [IP-021](./IP-021.md))
- VT-021-001: ID parsing + lane detection + ambiguity rules
- VT-021-002: next-ID allocation scans all lanes
- VT-021-003: create card copies template and rewrites only H1/Created
- VT-021-004: `show card -q` (path-only) behaviour and errors
- VT-021-005: `find card` repo-wide filename matching
- VT-021-006: `list cards` output formats (table/json/tsv)
- VH-021-001: manual UX sanity (create/list/show/find on a real repo)

**Acceptance Criteria**
- `uv run spec-driver create card "x"` creates `kanban/backlog/T###-x.md` and preserves
  all non-H1/Created template content verbatim.
- `uv run spec-driver show card T123 -q` prints exactly one path when unambiguous.
- `uv run spec-driver find card T123` lists all `T123-*.md` files repo-wide.
- `just` passes (format/lint/test/pylint) once implementation is complete.

## 7. Risks & Mitigations
- **Risk**: Ambiguous ID matches (multiple `T123-*.md`) – *Likelihood*: medium – *Impact*: medium – *Mitigation*: make ambiguity explicit; print candidates; provide `--anywhere` only as an expansion.
- **Risk**: Over-aggressive template rewriting – *Likelihood*: low – *Impact*: high – *Mitigation*: rewrite only the first H1 and `Created:` line; test against template variants.
- **Risk**: Cards not always in `kanban/` – *Likelihood*: medium – *Impact*: low – *Mitigation*: `find card` is repo-wide; `show card` supports `--anywhere`.

## 8. Follow-ups & Tracking
**Follow-ups (separate deltas or backlog)**
- `find refs <ID>`: repo-wide content search for ID mentions.
- Optional: `move card T123 --lane done` wrapper around `git mv`.

**Backlog Items**
- IMPR-003 – `backlog/improvements/IMPR-003-kanban-support/IMPR-003.md`

## 9. Implementation Notes
**Prior art**
- `deck_of_dwarf/kanban` `Justfile:new-card` uses filesystem scan + template copy.

**Naming**
- CLI uses `card` (not `kanban`) for ergonomics; storage remains `kanban/`.
