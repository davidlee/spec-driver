---
id: DE-023
slug: add-view-and-edit-commands
name: Add view and edit commands
created: '2026-02-04'
updated: '2026-02-04'
status: completed
kind: delta
aliases: []
relations: []
applies_to:
  specs:
  - PROD-013
  requirements:
  - PROD-013.FR-003
  - PROD-013.FR-004
---

# DE-023 – Add view and edit commands

```yaml supekku:delta.relationships@v1
schema: supekku.delta.relationships
version: 1
delta: DE-023
revision_links:
  introduces: []
  supersedes: []
specs:
  primary:
    - PROD-013
  collaborators: []
requirements:
  implements:
    - PROD-013.FR-003
    - PROD-013.FR-004
  updates: []
  verifies: []
phases:
  - IP-023-P01
```

## 1. Summary & Context

- **Product Spec**: [PROD-013](../../specify/product/PROD-013/PROD-013.md) – CLI Artifact File Access
- **Implementation Plan**: [IP-023](./IP-023.md)
- **Change Drivers**: PROD-013 Phase 2 - user-friendly artifact access

## 2. Motivation

Users want to quickly view or edit artifacts without manual path lookup. Current workflow:
1. Run `spec-driver show adr 001` to see metadata
2. Manually navigate to `specify/decisions/ADR-001-*.md`
3. Open in editor/pager

Target state:
- `spec-driver view adr 001` → opens in `$PAGER`
- `spec-driver edit adr 001` → opens in `$EDITOR`

## 3. Scope & Objectives

- **Primary Outcomes**:
  - `view` command opens artifact in pager (FR-003)
  - `edit` command opens artifact in editor (FR-004)
- **Operational Constraints**: Must handle missing $PAGER/$EDITOR gracefully
- **Dependencies**: None (can implement independently of DE-022)

## 4. Out of Scope

- `--path` and `--raw` flags (DE-022)
- `find` command extensions (future delta)
- Multi-file viewing (e.g., delta bundle as one view)

## 5. Approach Overview

- **System Touchpoints**: New CLI modules `supekku/cli/view.py`, `supekku/cli/edit.py`
- **Key Changes**:
  1. Create `view` command group with subcommands for each artifact type
  2. Create `edit` command group with subcommands for each artifact type
  3. Add helper for pager/editor resolution in `supekku/cli/common.py`
- **Migration Notes**: None - new functionality

## 6. Verification Strategy

- **Requirements Coverage**:
  - FR-003: Test view command with mocked $PAGER
  - FR-004: Test edit command with mocked $EDITOR
- **Planned Artefacts**: VT-023-001 (view tests), VT-023-002 (edit tests)
- **Acceptance Criteria**:
  - `spec-driver view adr ADR-001` opens in pager
  - `spec-driver edit adr ADR-001` opens in editor
  - Graceful error when pager/editor unavailable

## 7. Risks & Mitigations

- **Risk**: Subprocess spawning complexity – *Likelihood*: low – *Impact*: low – *Mitigation*: Use `subprocess.run()` with simple interface
- **Risk**: Platform differences (Windows) – *Likelihood*: medium – *Impact*: low – *Mitigation*: Document requirements; test on Linux/macOS

## 8. Follow-ups & Tracking

- **Future Deltas**:
  - DE-022: Add `--path` flag (can land before or after)
  - DE-TBD: Extend `find` command (PROD-013.FR-005)

## 9. Implementation Notes

Pager resolution order: `$PAGER` → `less` → `more`
Editor resolution order: `$EDITOR` → `$VISUAL` → `vi`

```python
import os
import shutil
import subprocess

def get_pager() -> str | None:
  if pager := os.environ.get("PAGER"):
    return pager
  for cmd in ("less", "more"):
    if shutil.which(cmd):
      return cmd
  return None

def get_editor() -> str | None:
  for var in ("EDITOR", "VISUAL"):
    if editor := os.environ.get(var):
      return editor
  if shutil.which("vi"):
    return "vi"
  return None

def open_in_pager(path: str) -> None:
  pager = get_pager()
  if not pager:
    raise RuntimeError("No pager found. Set $PAGER or install less.")
  subprocess.run([pager, path], check=True)

def open_in_editor(path: str) -> None:
  editor = get_editor()
  if not editor:
    raise RuntimeError("No editor found. Set $EDITOR or install vi.")
  subprocess.run([editor, path], check=True)
```
