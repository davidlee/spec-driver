---
id: IP-023
slug: add-view-and-edit-commands
name: Implementation Plan - Add view and edit commands
created: '2026-02-04'
updated: '2026-02-04'
status: draft
kind: plan
aliases: []
---

```yaml supekku:plan.overview@v1
schema: supekku.plan.overview
version: 1
plan: IP-023
delta: DE-023
revision_links:
  aligns_with:
  - DR-023
specs:
  primary:
  - PROD-013
  collaborators: []
requirements:
  targets:
  - PROD-013.FR-003
  - PROD-013.FR-004
  dependencies: []
phases:
- id: IP-023-P01
- id: IP-023.PHASE-01
- id: IP-023.PHASE-02
```

```yaml supekku:verification.coverage@v1
schema: supekku.verification.coverage
version: 1
subject: IP-023
entries:
  - artefact: VT-023-001
    kind: VT
    requirement: PROD-013.FR-003
    status: planned
    notes: Test view command with mocked pager
  - artefact: VT-023-002
    kind: VT
    requirement: PROD-013.FR-004
    status: planned
    notes: Test edit command with mocked editor
```

## 1. Summary

- **Delta**: DE-023 - Add view and edit commands
- **Specs Impacted**: PROD-013 (CLI Artifact File Access)
- **Desired Outcome**: `spec-driver view/edit <type> <id>` opens artifact in pager/editor

## 2. Context & Constraints

- **Current Behaviour**: No direct way to open artifacts
- **Target Behaviour**: PROD-013.FR-003, FR-004
- **Dependencies**: None
- **Constraints**: Must respect $PAGER/$EDITOR; graceful fallbacks

## 3. Gate Check

- [x] Spec created and linked (PROD-013)
- [x] Design revision complete (DR-023)
- [x] Test strategy identified (mock subprocess)
- [x] Implementation complete

## 4. Phase Overview

| Phase | Objective | Entrance Criteria | Exit Criteria | Phase Sheet |
| --- | --- | --- | --- | --- |
| Phase 1 | Implement view and edit commands | DR-023 approved | Commands work, tests pass | `phases/phase-01.md` |
| Phase 2 | Support numeric ID shorthand | Phase 1 complete | Shorthand works, tests pass | `phases/phase-02.md` |

## 5. Phase Detail Snapshot

- **Design Revision**: [DR-023](./DR-023.md)
- **Active Phase Sheet**: `phases/phase-01.md` (to be created)

## 6. Testing & Verification Plan

- **New Suites**: `supekku/cli/view_test.py`, `supekku/cli/edit_test.py`
- **New Cases**:
  - Test pager/editor resolution logic
  - Test command invocation (mock subprocess.run)
  - Test error handling (missing pager/editor, artifact not found)
- **Tooling**: pytest with monkeypatch for environment/subprocess

## 7. Risks & Mitigations

| Risk | Mitigation | Owner |
| --- | --- | --- |
| Platform differences | Document; test on Linux | Dev |

## 8. Open Questions & Decisions

None.

## 9. Progress Tracking

- [x] Phase 1 complete
- [x] Phase 2 complete
- [ ] Verification gates passed

## 10. Implementation Tasks

### Phase 1 Tasks

1. **Add helpers to common.py**
   - `get_pager()`, `get_editor()`
   - `open_in_pager()`, `open_in_editor()`

2. **Create view.py**
   - Command group with subcommands: adr, spec, delta, revision, requirement, policy, standard, card

3. **Create edit.py**
   - Same structure as view.py

4. **Register in main.py**
   - `app.add_typer(view.app, name="view")`
   - `app.add_typer(edit.app, name="edit")`

5. **Write tests**
   - `view_test.py`, `edit_test.py`
   - Mock subprocess.run to verify correct pager/editor invoked

6. **Lint and verify**
   - `just lint`
   - `just test`
